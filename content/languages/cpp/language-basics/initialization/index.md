---
title: 初始化与列表初始化
---

初始化形式
- 赋值初始化：`T a = expr;`
- 直接初始化：`T a(expr);`
- 列表初始化：`T a{expr};`（聚合/容器友好，防缩窄）
- 值初始化：`T()`；默认初始化：`T a;`（基本类型未初始化）

零/值/默认/聚合
- 零初始化：静态存储期或 `T{}` 的标量成员置零
- 值初始化：`T()` 调用默认构造或置零
- 默认初始化：`T a;` 基本类型未定义值；类调用默认构造
- 聚合初始化：聚合类型（无自定义 ctor、无私有非静态成员等）用 `{}` 按成员顺序初始化

列表初始化与缩窄（narrowing）
- `{}` 禁止潜在缩窄：如 `double`→`int`、`long long`→`float` 等会报错
```cpp
int a{3.5};   // 错误：缩窄
int b(3.5);   // 允许，产生截断
```

构造优先级与 `initializer_list`
- 存在 `std::initializer_list` 构造时，`{}` 优先匹配该构造
```cpp
std::vector<int> v{3, 1};   // 两元素
std::vector<int> w(3, 1);   // 3 个 1
```

指定成员初始化（C++20 聚合指定符）
```cpp
struct A{ int x; int y; };
A a{ .y=2, .x=1 }; // 支持的编译器可用（标准限制较多）
```

最佳实践
- 默认用 `{}`；需要精确重载/防止 `initializer_list` 介入时用 `()`
- 基本类型在局部作用域总是显式初始化
- 自定义类型提供“最少惊讶”的构造集合，避免二义性
