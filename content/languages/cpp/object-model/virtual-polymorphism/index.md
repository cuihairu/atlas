---
title: 虚函数与多态（virtual/override/final）
---

关键字与规则
- `virtual`：声明虚函数；`override`：显式覆盖检查；`final`：阻止进一步覆盖
- 纯虚函数：`=0` 构成抽象基类型（接口）
- 虚析构：作为多态基类必须有虚析构，防止派生经基指针析构不完全

对象切片
- 以值方式传/赋给基类对象会“切片”，丢失派生部分；多态应以引用/指针

dynamic_cast 与接口设计
- 运行时向下转型成本高；倾向以虚函数/访问者消除 `dynamic_cast`

成本与布局
- vptr/vtable 带来微小开销；`final`/`override` 有助优化与安全

最佳实践
- 以纯虚基类定义接口；避免在构造/析构中调用虚函数
- 使用 `override`/`final` 保证正确性；对非常小的类型/热路径，评估多态成本
